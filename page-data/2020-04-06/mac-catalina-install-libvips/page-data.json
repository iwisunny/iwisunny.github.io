{"componentChunkName":"component---src-templates-blog-post-js","path":"/2020-04-06/mac-catalina-install-libvips","result":{"data":{"site":{"siteMetadata":{"title":"WangXi","author":"sunnywang"}},"markdownRemark":{"id":"412233bd-0a56-5105-b952-04e0d84d276b","excerpt":"gatsby 的图片处理库很方便，但是 sharp 依赖 c++编写的 。\n当 Mac 升级到 catalina(10.15), 安装时一直失败，当尝试源码编译，会出现依赖的错误。\n还有在 catalina 默认的 的配置错误。针对我遇到的情形，解决方式如下。 改进之处 在 markdown 内引入 png…","html":"<p>gatsby 的图片处理库<code class=\"language-text\">sharp</code>很方便，但是 sharp 依赖 c++编写的 <code class=\"language-text\">libvips</code>。\n当 Mac 升级到 catalina(10.15), <code class=\"language-text\">brew</code>安装时一直失败，当尝试源码编译，会出现<code class=\"language-text\">tiff</code>依赖的错误。\n还有<code class=\"language-text\">zlib</code>在 catalina 默认的 <code class=\"language-text\">pkg-config</code>的配置<code class=\"language-text\">zlib.pc</code>错误。针对我遇到的情形，解决方式如下。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">// 从github 下载最新的gz包，vips-8.9.1.tar.gz\n\ntar xf vips-8.9.1.tar.gz\ncd vips-8.9.1\n\n./configuration --with-jpeg --with-png --without-tiff\n\nmake\n\nsudo make install\n\nrm -rf node_modules\n\nnpm i --unsafe-perm --build-from-source --verbose</code></pre></div>\n<p>改进之处</p>\n<ul>\n<li>在 markdown 内引入 png 图片，gatsby 有时会编译出错 (可能是 libvips 编译的参数不对， 或者<code class=\"language-text\">gatsby-plugin-sharp</code>的 bug)</li>\n<li><code class=\"language-text\">brew info vips</code> 显示的 vips 版本始终是 8.8.x，尝试升级 brew，拉取<code class=\"language-text\">brew/versions</code>仓库也报错，可能是<code class=\"language-text\">brew/core</code>的 bug</li>\n<li>等 brew 官方发新版，最简单的就是通过<code class=\"language-text\">brew install vips</code>安装 libvips</li>\n</ul>\n<p>参考文档</p>\n<ul>\n<li><a href=\"https://sharp.pixelplumbing.com/install\">https://sharp.pixelplumbing.com/install</a></li>\n<li><a href=\"https://libvips.github.io/libvips/install.html#building-libvips-from-a-source-tarball\">https://libvips.github.io/libvips/install.html#building-libvips-from-a-source-tarball</a></li>\n<li><a href=\"https://github.com/gatsbyjs/gatsby/issues/21032\">https://github.com/gatsbyjs/gatsby/issues/21032</a></li>\n</ul>","frontmatter":{"title":"Mac 10.15 安装 libvips","date":"April 06, 2020","description":"mac安装gatsby图片处理依赖的libvips和sharp的问题记录"}}},"pageContext":{"slug":"/2020-04-06/mac-catalina-install-libvips","previous":{"fields":{"slug":"/2019-10-26-google-advanced-operators"},"frontmatter":{"title":"google搜索算子"}},"next":{"fields":{"slug":"/2020-04-07/django-webpack-hot-reload"},"frontmatter":{"title":"django webpack hot reload"}}}}}